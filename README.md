###Юшков Артём Витальевич УИБО-13-24

# Контрольная работа 2
  
## Задание 1. SQL-injection и логин с административными правами
При вводе значка ' в поле логин и случаного пароля получаем странный ответ.
<img width="1919" height="986" alt="image" src="https://github.com/user-attachments/assets/842e0114-846f-44f2-8771-5d771977d0ac" />
<img width="1903" height="909" alt="image" src="https://github.com/user-attachments/assets/93e21249-2a05-4c90-937d-269988de721d" />



Ошибка показывет что проблема с базой данной а не с введнном паролем
Это означает что база данных пользователей реализована с уязвимостями

Ввод ' OR true; выдает все еще же ту ошибку надо сделать так чтобы только эттот код использовался без посторониих - поэтому пишем ' or 1=1; это позволило залогиниться по пользователем admin@juice-sh.op. Предположим, что это администратор.
<img width="1917" height="916" alt="image" src="https://github.com/user-attachments/assets/f69ab87b-654d-4b75-acda-b122e9feb8cf" />

<img width="1168" height="852" alt="image" src="https://github.com/user-attachments/assets/d06b46e9-f141-4c1d-b0b0-73c766ed1d4e" />
<img width="1163" height="914" alt="image" src="https://github.com/user-attachments/assets/de15cff8-7bd0-415a-ac5b-d46f1329a311" />
<img width="1169" height="912" alt="image" src="https://github.com/user-attachments/assets/c641b2df-e683-4d36-8a72-a967aceebeb7" />




## Ответы на вопросы
### 1. SQL-инъекция — это уязвимость, позволяющая злоумышленнику выполнить произвольный SQL-код через ненадежные входные данные.

### 2. ' or 1=1;-- обходит аутентификацию, потому что:

' закрывает строковый параметр

or 1=1 делает условие всегда истинным

;-- завершает запрос и закомментирует остальную часть

### 3. Защита:

Использование параметризованных запросов (prepared statements)

Валидация и экранирование входных данных

Принцип минимальных привилегий для БД

Регулярное тестирование на уязвимости


## Задание 2. Узнайте пароль администратора

Почта: admin@juice-sh.op

Находясь после SQL под логином администратора - включаем DevTools и обновляем страницу OWAS Juice. Переходим в запрос домена - и находим заголовок кукис. Находим IDTOKEN
<img width="1917" height="977" alt="image" src="https://github.com/user-attachments/assets/bd6ac3d0-8666-4f6b-9f72-0a28d25ea30d" />
<img width="1909" height="736" alt="image" src="https://github.com/user-attachments/assets/9cd3a2e1-6c30-483d-ac1d-d90da10122f3" />



Копируем его Декодируем онлайн на определённых сайтах. Получаем результат:


 Хэш "password": "0192023a7bbd73250516f069df18b500". Атака на него даже с помощью онлайн крэкера позволяет узнать строку пароля - admin123:



Пароль: admin123
## Ответы на вопросы
### 1. Какой логин у администратора?
admin@juice-sh.op
### 2. Какой хэш пароля у администратора? 
Хэш "password": "0192023a7bbd73250516f069df18b500"
### 3. Какой пароль администратора?
Пароль: admin123
### 4. Что такое cookie?
Cookie — это небольшой фрагмент данных, который веб-сервер отправляет браузеру, и который браузер сохраняет и автоматически пересылает обратно с каждым последующим запросом к тому же серверу.
### 5. Какие меры могут быть использованы для устранения выявленной уязвимости? 
Меры для устранения уязвимостей при работе с cookies:
##Безопасная конфигурация:
HttpOnly - запрет доступа к cookie через JavaScript (защита от XSS)

Secure - передача только по HTTPS

SameSite - защита от CSRF-атак (Strict/Lax)

Установка срока действия (Expires/Max-Age)

##Защита данных:
Шифрование конфиденциальных данных в cookie

Цифровая подпись для проверки целостности

Не хранить чувствительные данные (пароли, персональные данные)

##Сессионные cookie:
Использование случайных, непредсказуемых идентификаторов сессии

Регулярная ротация идентификаторов сессии

Принудительное завершение сессии при logout

##Дополнительные меры:
Валидация origin/referer заголовков

Ограничение домена и пути для cookie

Регулярная инвалидация старых сессий


## Задание 3. «Чужая корзина»

Открыл свою корзину и начал смотреть в session storage

Начал изменять количество товаров, вижу что меняется itemtotal
Предпологаю что bid это индентификатор, изменяю число bid на 4
вижу что корзина меняется и остается такой же при перезагрузке страницы, корзина изменена на корзину другого пользователя
<img width="1918" height="1017" alt="image" src="https://github.com/user-attachments/assets/3e4d66e1-212d-46f1-bba1-2a0052277a32" />


### 1. Наименование параметра, который отвечает за открываемую корзину.
BID
### 2. Ваши рекомендации по исправлению этой незначительной уязвимости
Необходимо реализовать строгую привязку сессионной корзины к конкретному пользователю, проверяя перед любыми изменениями (добавлением, изменением, удалением товаров), что идентификатор текущего аутентифицированного пользователя совпадает с идентификатором владельца корзины в сессии, а также исключить возможность передачи или изменения идентификатора корзины (BID) через клиентскую часть (например, скрытые поля форм, параметры URL или API-запросы), генерируя и используя уникальный, криптографически стойкий идентификатор сессии на сервере для каждой новой пользовательской сессии.

## Задание 4. XSS-инъекция
Ввожу в поле поиска `<h1>owasp<h1>` для проверки возможности XSS-инъекция


Видим что успешно создался элемент, можно попробовать что-то более интересное
<img width="1908" height="914" alt="image" src="https://github.com/user-attachments/assets/5dc5c9f9-cfaa-4ebf-88d6-eee6480d80a8" />
<img width="1919" height="920" alt="image" src="https://github.com/user-attachments/assets/575b9322-7236-44b3-9942-4ee4678b189e" />

Также можно придумывать как использовать эту уязвимость в своих целях


Это показывает что сайт уязвим к XXS-инъекциям.



